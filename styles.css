/* ============ DESIGN SYSTEM: COLOR TOKENS ============ */

/* Core Tokens (primitives) */
:root{
  /* Neutrals */
  --core-white:#ffffff;
  --core-black:#000000;

  /* Brand / Accent primitives */
  --core-yellow-500:#f0b429;
  --core-yellow-300:#fdd868;
  --core-yellow-700:#c98a00;

  --core-teal-500:#38c9b0;
  --core-teal-300:#7eecd9;

  --core-rose-500:#e85d75;

  --core-green-500:#52d68a;

  --core-purple-500:#9b59b6;

  /* Theme preview tokens (used in theme cards, independent of active theme) */
  --preview-day-1:#fff3d0;
  --preview-day-2:#fff8e8;
  --preview-girls-1:#ffe0f0;
  --preview-girls-2:#fce4f6;
  --preview-boys-1:#d5eedd;
  --preview-boys-2:#e4f2e8;
  --preview-night-text:#e8d9b5;
  --preview-warm-1:#ffb347;
  --preview-warm-2:#6a0dad;

  /* State palette (shared) */
  --core-success-600:#27ae60;
  --core-success-500:#2ecc71;
  --core-success-400:#52d68a;

  --core-warning-600:#f39c12;
  --core-warning-500:#ff6b35;

  --core-danger-500:#e85d75;

  /* Alpha Tokens — White */
  --alpha-white-02:rgba(255,255,255,0.02);
  --alpha-white-03:rgba(255,255,255,0.03);
  --alpha-white-04:rgba(255,255,255,0.04);
  --alpha-white-05:rgba(255,255,255,0.05);
  --alpha-white-06:rgba(255,255,255,0.06);
  --alpha-white-07:rgba(255,255,255,0.07);
  --alpha-white-08:rgba(255,255,255,0.08);
  --alpha-white-10:rgba(255,255,255,0.10);
  --alpha-white-12:rgba(255,255,255,0.12);
  --alpha-white-13:rgba(255,255,255,0.13);
  --alpha-white-14:rgba(255,255,255,0.14);
  --alpha-white-15:rgba(255,255,255,0.15);
  --alpha-white-18:rgba(255,255,255,0.18);
  --alpha-white-20:rgba(255,255,255,0.20);
  --alpha-white-22:rgba(255,255,255,0.22);
  --alpha-white-28:rgba(255,255,255,0.28);
  --alpha-white-30:rgba(255,255,255,0.30);
  --alpha-white-40:rgba(255,255,255,0.40);
  --alpha-white-50:rgba(255,255,255,0.50);
  --alpha-white-55:rgba(255,255,255,0.55);
  --alpha-white-85:rgba(255,255,255,0.85);
  --alpha-white-90:rgba(255,255,255,0.90);

  /* Alpha Tokens — Black */
  --alpha-black-05:rgba(0,0,0,0.05);
  --alpha-black-09:rgba(0,0,0,0.09);
  --alpha-black-10:rgba(0,0,0,0.10);
  --alpha-black-12:rgba(0,0,0,0.12);
  --alpha-black-22:rgba(0,0,0,0.22);
  --alpha-black-25:rgba(0,0,0,0.25);
  --alpha-black-35:rgba(0,0,0,0.35);
  --alpha-black-45:rgba(0,0,0,0.45);
  --alpha-black-72:rgba(0,0,0,0.72);

  /* Accent alpha tokens */
  --alpha-accent-06:color-mix(in srgb, var(--core-yellow-500) 6%, transparent);
  --alpha-accent-08:color-mix(in srgb, var(--core-yellow-500) 8%, transparent);
  --alpha-accent-10:color-mix(in srgb, var(--core-yellow-500) 10%, transparent);
  --alpha-accent-12:color-mix(in srgb, var(--core-yellow-500) 12%, transparent);
  --alpha-accent-15:color-mix(in srgb, var(--core-yellow-500) 15%, transparent);
  --alpha-accent-20:color-mix(in srgb, var(--core-yellow-500) 20%, transparent);
  --alpha-accent-22:color-mix(in srgb, var(--core-yellow-500) 22%, transparent);
  --alpha-accent-25:color-mix(in srgb, var(--core-yellow-500) 25%, transparent);
  --alpha-accent-30:color-mix(in srgb, var(--core-yellow-500) 30%, transparent);
  --alpha-accent-45:color-mix(in srgb, var(--core-yellow-500) 45%, transparent);
  --alpha-accent-50:color-mix(in srgb, var(--core-yellow-500) 50%, transparent);
  --alpha-accent-60:color-mix(in srgb, var(--core-yellow-500) 60%, transparent);
  --alpha-accent-65:color-mix(in srgb, var(--core-yellow-500) 65%, transparent);
  --alpha-accent-90:color-mix(in srgb, var(--core-yellow-500) 90%, transparent);
  --alpha-accent-95:color-mix(in srgb, var(--core-yellow-500) 95%, transparent);
  --alpha-accent-100:var(--core-yellow-500);

  --alpha-teal-08:color-mix(in srgb, var(--core-teal-500) 8%, transparent);
  --alpha-teal-10:color-mix(in srgb, var(--core-teal-500) 10%, transparent);
  --alpha-teal-12:color-mix(in srgb, var(--core-teal-500) 12%, transparent);
  --alpha-success-10:color-mix(in srgb, var(--core-success-400) 10%, transparent);
  --alpha-success-18:color-mix(in srgb, var(--core-success-400) 18%, transparent);
  --alpha-rose-08:color-mix(in srgb, var(--core-rose-500) 8%, transparent);
  --alpha-rose-10:color-mix(in srgb, var(--core-rose-500) 10%, transparent);

  /* Radii / typography tokens */
  --r:18px;
  --font:'Tajawal',sans-serif;
}

/* ============ THEME TOKENS ============ */

/* Night theme (default) */
:root,[data-theme="night"]{
  --theme-bg:#0d1b3e;
  --theme-bg-2:#162040;
  --theme-bg-3:#243566;

  --theme-accent:var(--core-yellow-500);
  --theme-accent-2:var(--core-yellow-300);
  --theme-accent-3:var(--core-yellow-700);

  --theme-teal:var(--core-teal-500);
  --theme-teal-2:var(--core-teal-300);

  --theme-rose:var(--core-rose-500);
  --theme-green:var(--core-green-500);
  --theme-purple:var(--core-purple-500);

  --theme-text:#e8d9b5;
  --theme-muted:#a0b0cc;

  --theme-surface-1:rgba(255,255,255,0.07);
  --theme-surface-2:rgba(255,255,255,0.13);
  --theme-border:rgba(240,180,41,0.22);
  --theme-shadow:0 8px 32px rgba(0,0,0,0.45);

  --theme-color:var(--theme-accent);

  --overlay-deep-95:color-mix(in srgb, #0d1b3e 95%, var(--core-black));
}

[data-theme="day"]{
  --theme-bg:#fff8e8;
  --theme-bg-2:#fffbf0;
  --theme-bg-3:#fff3d0;

  --theme-accent:var(--core-yellow-500);
  --theme-accent-2:#c48000;
  --theme-accent-3:#5a3a00;

  --theme-teal:#006b58;
  --theme-teal-2:#009977;

  --theme-rose:#c00028;
  --theme-green:#1a6b2a;
  --theme-purple:#5a1fa0;

  --theme-text:#3a2800;
  --theme-muted:#6a4820;

  --theme-surface-1:rgba(0,0,0,0.05);
  --theme-surface-2:rgba(0,0,0,0.09);
  --theme-border:rgba(138,92,0,0.22);
  --theme-shadow:0 4px 16px rgba(0,0,0,0.10);

  --theme-color:var(--theme-accent);

  --overlay-deep-95:color-mix(in srgb, #fff8e8 95%, var(--core-black));
}

[data-theme="girls"]{
  --theme-bg:#fff0f8;
  --theme-bg-2:#fce4f6;
  --theme-bg-3:#ffe0f0;

  --theme-accent:#e8009a;
  --theme-accent-2:#e8008a;
  --theme-accent-3:#8a004a;

  --theme-teal:#7700b8;
  --theme-teal-2:#aa22e0;

  --theme-rose:#c00040;
  --theme-green:#6600a0;
  --theme-purple:#aa00cc;

  --theme-text:#3a0028;
  --theme-muted:#7a3055;

  --theme-surface-1:rgba(192,0,106,0.06);
  --theme-surface-2:rgba(192,0,106,0.12);
  --theme-border:rgba(192,0,106,0.20);
  --theme-shadow:0 4px 16px rgba(150,0,80,0.12);

  --theme-color:var(--theme-accent);

  --overlay-deep-95:color-mix(in srgb, #fff0f8 95%, var(--core-black));
}

[data-theme="boys"]{
  --theme-bg:#f2f8f3;
  --theme-bg-2:#e4f2e8;
  --theme-bg-3:#d5eedd;

  --theme-accent:var(--core-yellow-500);
  --theme-accent-2:#28a000;
  --theme-accent-3:#104500;

  --theme-teal:#005f80;
  --theme-teal-2:#0088aa;

  --theme-rose:#c03000;
  --theme-green:#005500;
  --theme-purple:#3a3ab0;

  --theme-text:#1a2e1a;
  --theme-muted:#3a5a32;

  --theme-surface-1:rgba(26,107,0,0.06);
  --theme-surface-2:rgba(26,107,0,0.12);
  --theme-border:rgba(26,107,0,0.20);
  --theme-shadow:0 4px 16px rgba(0,80,0,0.10);

  --theme-color:var(--theme-accent);

  --overlay-deep-95:color-mix(in srgb, #f2f8f3 95%, var(--core-black));
}

/* ============ SEMANTIC TOKENS ============ */
:root{
  /* Surfaces */
  --surface-bg:var(--theme-bg);
  --surface-bg-2:var(--theme-bg-2);
  --surface-bg-3:var(--theme-bg-3);
  --surface-1:var(--theme-surface-1);
  --surface-2:var(--theme-surface-2);

  /* Brand */
  --brand-accent:var(--theme-accent);
  --brand-accent-2:var(--theme-accent-2);
  --brand-accent-3:var(--theme-accent-3);

  /* Text */
  --text-primary:var(--theme-text);
  --text-muted:var(--theme-muted);

  /* State */
  --state-success-600:var(--core-success-600);
  --state-success-500:var(--core-success-500);
  --state-success-400:var(--core-success-400);
  --state-warning-600:var(--core-warning-600);
  --state-warning-500:var(--core-warning-500);
  --state-danger-500:var(--core-danger-500);

  /* Borders / shadows */
  --border-default:var(--theme-border);
  --shadow-elevated:var(--theme-shadow);
}

/* Backward-compatible aliases */
:root{
  --bg:var(--surface-bg);
  --bg2:var(--surface-bg-2);
  --bg3:var(--surface-bg-3);
  --accent:var(--brand-accent);
  --accent2:var(--brand-accent-2);
  --accent3:var(--brand-accent-3);
  --teal:var(--theme-teal);
  --teal2:var(--theme-teal-2);
  --rose:var(--theme-rose);
  --green:var(--theme-green);
  --purple:var(--theme-purple);
  --text:var(--text-primary);
  --muted:var(--text-muted);
  --surf:var(--surface-1);
  --surf2:var(--surface-2);
  --bdr:var(--border-default);
  --shadow:var(--shadow-elevated);

  /* Text-on-* tokens */
  --text-on-accent:color-mix(in srgb, var(--brand-accent) 15%, var(--core-black));
  --text-on-teal:var(--core-white);
  --text-on-green:color-mix(in srgb, var(--state-success-500) 20%, var(--core-black));
  --text-on-rose:var(--core-white);
  --text-on-done:color-mix(in srgb, var(--state-success-500) 20%, var(--core-black));
}



/* ============ COMPAT: color-mix() fallback ============ */
@supports not (color: color-mix(in srgb, #000 50%, #fff)){
  :root{
    /* Safe fallbacks when color-mix isn't supported */
    --alpha-accent-06:rgba(240,180,41,0.06);
    --alpha-accent-08:rgba(240,180,41,0.08);
    --alpha-accent-10:rgba(240,180,41,0.10);
    --alpha-accent-12:rgba(240,180,41,0.12);
    --alpha-accent-15:rgba(240,180,41,0.15);
    --alpha-accent-20:rgba(240,180,41,0.20);
    --alpha-accent-22:rgba(240,180,41,0.22);
    --alpha-accent-25:rgba(240,180,41,0.25);
    --alpha-accent-30:rgba(240,180,41,0.30);
    --alpha-accent-45:rgba(240,180,41,0.45);
    --alpha-accent-50:rgba(240,180,41,0.50);
    --alpha-accent-60:rgba(240,180,41,0.60);
    --alpha-accent-65:rgba(240,180,41,0.65);
    --alpha-accent-90:rgba(240,180,41,0.90);
    --alpha-accent-95:rgba(240,180,41,0.95);

    --alpha-teal-08:rgba(56,201,176,0.08);
    --alpha-teal-10:rgba(56,201,176,0.10);
    --alpha-teal-12:rgba(56,201,176,0.12);

    --alpha-success-10:rgba(82,214,138,0.10);
    --alpha-success-18:rgba(82,214,138,0.18);

    --alpha-rose-08:rgba(232,93,117,0.08);
    --alpha-rose-10:rgba(232,93,117,0.10);

    /* Text-on tokens */
    --text-on-accent:#1a1000;
    --text-on-green:#103000;
    --text-on-done:#103000;
  }
}

/* ============ BASE ============ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px}
body{
  font-family:var(--font);background:var(--bg);color:var(--text);
  direction:rtl;text-align:right;min-height:100vh;
  overflow-x:hidden;-webkit-tap-highlight-color:transparent;
  transition:background 0.3s,color 0.3s;
}
/* Arabic text safety */
body,button,input,textarea{overflow-wrap:anywhere;word-break:break-word}

body::before{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:radial-gradient(1px 1px at 20% 30%,var(--alpha-white-40) 0%,transparent 100%),
    radial-gradient(1px 1px at 60% 20%,var(--alpha-white-50) 0%,transparent 100%),
    radial-gradient(1px 1px at 80% 70%,var(--alpha-white-30) 0%,transparent 100%),
    radial-gradient(1px 1px at 35% 55%,var(--alpha-accent-30) 0%,transparent 100%);
}
[data-theme="day"] body::before,[data-theme="girls"] body::before,[data-theme="boys"] body::before{opacity:0.2}
#app{max-width:520px;margin:0 auto;min-height:100vh;position:relative;z-index:1;padding-bottom:90px}

/* ====== RAMADAN PATH MAP ====== */
#ramadan-path-map{padding:10px 0 20px;position:relative;user-select:none}
.rpath-row{display:flex;align-items:center;justify-content:center;gap:0;margin-bottom:0;position:relative}
.rpath-row.rtl-row{flex-direction:row-reverse}

/* Path connector line */
.rpath-line{flex:1;height:6px;border-radius:3px;background:var(--bdr);position:relative;min-width:10px;max-width:32px}
.rpath-line.done-line{background:linear-gradient(90deg,var(--green),var(--state-success-400))}
.rpath-line.today-line{background:linear-gradient(90deg,var(--green),var(--accent))}

/* Vertical connector between rows */
.rpath-vline-wrap{display:flex;align-items:center;justify-content:flex-start;padding-right:24px;margin:0}
.rpath-vline-wrap.rtl-side{justify-content:flex-end;padding-right:0;padding-left:24px}
.rpath-vline{width:6px;height:28px;border-radius:3px;background:var(--bdr)}
.rpath-vline.done-vline{background:linear-gradient(180deg,var(--green),var(--state-success-400))}

/* Day node */
.rday{width:52px;height:52px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;font-family:var(--font);cursor:default;position:relative;flex-shrink:0;transition:transform .2s;border:3px solid transparent}

/* States */
.rday.rd-done{background:linear-gradient(135deg,var(--state-success-500),var(--state-success-600));border-color:var(--state-success-600);box-shadow:0 3px 10px color-mix(in srgb, var(--state-success-500) 40%, transparent)}
.rday.rd-done .rday-num{color:var(--core-white);font-weight:900;font-size:0.9rem}
.rday.rd-done .rday-icon{font-size:1rem}

.rday.rd-missed{background:linear-gradient(135deg,var(--state-danger-500),var(--state-danger-500));border-color:var(--state-danger-500);box-shadow:0 3px 8px color-mix(in srgb, var(--state-danger-500) 35%, transparent)}
.rday.rd-missed .rday-num{color:var(--core-white);font-weight:900;font-size:0.9rem}
.rday.rd-missed .rday-icon{font-size:1rem}

.rday.rd-today{background:linear-gradient(135deg,var(--accent),var(--preview-warm-1));border-color:var(--accent);box-shadow:0 0 0 4px var(--alpha-accent-30),0 3px 12px var(--alpha-accent-50);animation:pulse-today 2s ease-in-out infinite}
.rday.rd-today .rday-num{color:color-mix(in srgb, var(--core-black) 90%, var(--text-primary));font-weight:900;font-size:0.9rem}
.rday.rd-today .rday-icon{font-size:1.1rem}

.rday.rd-locked{background:var(--surf2);border-color:var(--bdr);opacity:0.5}
.rday.rd-locked .rday-num{color:var(--muted);font-size:0.85rem}
.rday.rd-locked .rday-icon{font-size:0.85rem}

/* Milestone nodes */
.rday.rd-milestone{width:62px;height:62px}
.rday.rd-milestone .rday-num{font-size:0.95rem}
.rday.rd-milestone .rday-icon{font-size:1.3rem}

.rday-num{line-height:1;margin-bottom:1px}
.rday-icon{line-height:1}

@keyframes pulse-today{
  0%,100%{box-shadow:0 0 0 4px var(--alpha-accent-30),0 3px 12px var(--alpha-accent-50)}
  50%{box-shadow:0 0 0 8px var(--alpha-accent-15),0 3px 16px var(--alpha-accent-60)}
}

/* Path legend */
.path-legend{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:8px;margin-bottom:16px}
.legend-item{display:flex;align-items:center;gap:5px;font-size:0.72rem;color:var(--muted)}
.legend-dot{width:12px;height:12px;border-radius:50%}

/* Milestone label */
.milestone-label{position:absolute;top:-22px;left:50%;transform:translateX(-50%);white-space:nowrap;font-size:0.62rem;font-weight:700;color:var(--accent);background:var(--alpha-accent-15);border:1px solid var(--alpha-accent-30);padding:1px 6px;border-radius:8px}

.path-section{position:relative;padding:0 8px}
.path-row{display:flex;align-items:flex-end;justify-content:center;padding:4px 0}
.path-row.ltr{flex-direction:row}
.path-row.rtl{flex-direction:row-reverse}
.path-node{display:flex;flex-direction:column;align-items:center;width:60px;flex-shrink:0;position:relative}
.path-connector{width:14px;height:4px;background:var(--bdr);border-radius:2px;align-self:center;margin-bottom:26px;flex-shrink:0}
.path-connector.done-conn{background:var(--state-success-500)}
.path-connector.miss-conn{background:var(--state-danger-500)}
.path-connector.today-conn{background:linear-gradient(90deg,var(--state-success-500),var(--accent))}

.path-btn{width:52px;height:52px;border-radius:50%;border:3px solid var(--bdr);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  font-size:1.25rem;position:relative;transition:transform .15s;
  background:var(--surf2);box-shadow:0 3px 8px var(--alpha-black-25);cursor:default}
.path-btn .day-num{font-size:0.58rem;font-weight:900;line-height:1;margin-top:1px;color:var(--alpha-white-85)}
.path-btn .day-lbl{font-size:0.6rem;font-weight:700;margin-top:4px;color:var(--muted);text-align:center;max-width:58px;line-height:1.2;white-space:nowrap}

.path-btn.st-done{background:linear-gradient(145deg,var(--state-success-500),var(--state-success-600));border-color:var(--state-success-600);box-shadow:0 4px 12px color-mix(in srgb, var(--state-success-500) 40%, transparent)}
.path-btn.st-today{background:linear-gradient(145deg,var(--accent),var(--state-warning-600));border-color:var(--accent);width:60px;height:60px;font-size:1.45rem;
  box-shadow:0 0 0 5px var(--alpha-accent-25),0 4px 16px var(--alpha-accent-50);
  animation:pulseToday 2s ease-in-out infinite}
.path-btn.st-missed{background:linear-gradient(145deg,var(--state-danger-500),var(--state-danger-500));border-color:var(--state-danger-500);box-shadow:0 4px 12px color-mix(in srgb, var(--state-danger-500) 40%, transparent)}
.path-btn.st-locked{background:var(--surf);border-color:var(--bdr);opacity:.5}
.path-btn.st-done .day-num,.path-btn.st-today .day-num,.path-btn.st-missed .day-num{color:var(--core-white)}
@keyframes pulseToday{0%,100%{box-shadow:0 0 0 5px var(--alpha-accent-25),0 4px 16px var(--alpha-accent-50)}50%{box-shadow:0 0 0 10px var(--alpha-accent-10),0 4px 20px var(--alpha-accent-65)}}

/* SVG curve between rows */
.path-turn{display:flex;justify-content:center;height:34px;overflow:visible;margin:0 4px}
.path-milestone{background:var(--alpha-accent-10);border:1.5px solid var(--accent);border-radius:12px;
  padding:6px 14px;margin:8px 14px 10px;text-align:center;font-size:0.78rem;
  font-weight:700;color:var(--accent);display:flex;align-items:center;justify-content:center;gap:6px}

/* Parent tab buttons */
.ptab-btn{background:var(--surf);border:1.5px solid var(--bdr);border-radius:12px;padding:10px 6px;
  font-family:var(--font);font-size:0.78rem;font-weight:700;color:var(--muted);cursor:pointer;
  display:flex;flex-direction:column;align-items:center;gap:4px;transition:all .15s;min-height:58px;line-height:1.2}
.ptab-btn span{font-size:0.75rem}
.ptab-btn.active,.ptab-btn:active{background:var(--accent);border-color:var(--accent);color:var(--core-black)}
.ptab-btn:hover:not(.active){border-color:var(--accent);color:var(--accent)}

/* ============ RESPONSIVE DESIGN ============ */
*{box-sizing:border-box}
img,video,iframe,canvas,svg{max-width:100%;height:auto}
.screen{padding:16px 14px;overflow-x:hidden}

/* Cards don't overflow */
.card{overflow:hidden;word-break:break-word}
.child-card,.shop-item,.deed-btn,.quest-item{word-break:break-word;overflow:hidden}
.card,.shop-item,.quiz-opt{overflow-wrap:break-word}

/* Text truncation for names */
.child-card .bold,.shop-item .bold{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:100%}

/* 320px — very small phones */
@media(max-width:360px){
  html{font-size:13.5px}
  .screen{padding:12px 10px}
  .timer-display{font-size:2rem!important}
  .welcome-title{font-size:1.7rem}
  .welcome-moon{font-size:3.5rem}
  .stats-grid{grid-template-columns:repeat(2,1fr)!important}
  .deeds-grid{grid-template-columns:repeat(2,1fr)!important}
  .ptab-btn{font-size:0.7rem;padding:8px 4px;min-height:52px}
  .ptab-btn span{font-size:0.68rem}
  #app{padding-bottom:70px}
  .btn{font-size:0.9rem;padding:11px 14px}
  .cert-name{font-size:1.4rem!important}
}

/* 361–480px — typical phones */
@media(min-width:361px) and (max-width:480px){
  html{font-size:15px}
  .stats-grid{grid-template-columns:repeat(2,1fr)!important}
}

@media(max-width:375px){
  html{font-size:14px}
  .timer-display{font-size:2.2rem}
  .cert-name{font-size:1.5rem}
}

@media(max-width:420px){
  .timer-display{font-size:2.8rem;letter-spacing:2px}
  .timer-card{padding:18px 14px 16px}
}

@media(max-width:480px){
  .shop-grid{grid-template-columns:repeat(2,1fr);gap:10px}
  .shop-item{padding:10px}
}

/* 481–767px — large phones / small tablets */
@media(min-width:481px){
  html{font-size:15.5px}
  .deeds-grid{grid-template-columns:repeat(3,1fr)!important}
  .stats-grid{grid-template-columns:repeat(4,1fr)!important}
  .ach-grid{grid-template-columns:repeat(4,1fr)!important}
  #app{max-width:540px}
  #nav{max-width:540px}
}

@media(max-width:600px){
  .shop-grid{grid-template-columns:repeat(2,1fr)!important}
}

@media(min-width:600px){
  .deeds-grid{grid-template-columns:repeat(3,1fr)}
  .stats-grid{grid-template-columns:repeat(4,1fr)}
  .ach-grid{grid-template-columns:repeat(4,1fr)}
  .shop-grid{grid-template-columns:repeat(3,1fr)}
}

/* 601–767 */
@media(min-width:601px){
  .shop-grid{grid-template-columns:repeat(3,1fr)!important}
}

/* 768px+ — tablets */
@media(min-width:768px){
  html{font-size:16.5px}
  .screen{padding:22px 20px}
  #app{max-width:620px}
  #nav{max-width:620px}
  .ptab-btn{font-size:0.85rem;padding:12px 8px}
}

/* 900px+ */
@media(min-width:900px){
  .shop-grid{grid-template-columns:repeat(4,1fr)!important}
}

/* 1024px+ — desktop */
@media(min-width:1024px){
  html{font-size:17px}
  #app{max-width:700px}
  #nav{max-width:700px}
}

/* ============ SCREENS ============ */
.screen{display:none;flex-direction:column;padding:20px 16px;min-height:calc(100vh - 80px);animation:fadeIn .2s ease}
.screen.active{display:flex}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.screen-title{font-size:1.3rem;font-weight:900;color:var(--accent);margin-bottom:16px;text-align:center}

/* ============ BUTTONS ============ */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:6px;
  padding:13px 20px;border-radius:var(--r);border:none;font-family:var(--font);
  font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;min-height:44px;
}
.btn:active{transform:scale(0.95);opacity:0.9}
.btn-block{width:100%}
.btn-lg{padding:16px 24px;font-size:1.1rem;border-radius:22px}
.btn-sm{padding:9px 13px;font-size:0.85rem;border-radius:11px;min-height:40px}
.btn-primary{background:var(--accent);color:var(--text-on-accent)}
.btn-secondary{background:var(--teal);color:var(--core-white)}
.btn-danger{background:var(--rose);color:var(--core-white)}
.btn-ghost{background:var(--surf);color:var(--text);border:1.5px solid var(--bdr)}
.btn-outline{background:transparent;color:var(--accent);border:2px solid var(--accent)}
.btn-success{background:var(--green);color:var(--core-white)}
.btn:disabled{opacity:0.4;cursor:not-allowed;transform:none}

/* ============ CARDS / FORMS ============ */
.card{background:var(--surf);border:1px solid var(--bdr);border-radius:var(--r);padding:16px;margin-bottom:10px}
.card-accent{border-color:var(--accent);background:var(--alpha-accent-06)}
input,textarea,select{
  width:100%;padding:11px 13px;background:var(--surf);border:1.5px solid var(--bdr);
  border-radius:12px;color:var(--text);font-family:var(--font);font-size:1rem;outline:none;min-height:44px;
}
input:focus,textarea:focus,select:focus{border-color:var(--accent)}
select option{background:var(--bg2);color:var(--text)}
input[type=range]{-webkit-appearance:none;appearance:none;height:6px;border-radius:3px;background:var(--surf2);padding:0;border:none}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;background:var(--accent);cursor:pointer}

/* ============ UTILS ============ */
.hidden{display:none!important}
.flex{display:flex;align-items:center}
.flex-col{display:flex;flex-direction:column}
.gap-6{gap:6px}.gap-8{gap:8px}.gap-10{gap:10px}.gap-12{gap:12px}
.mt-8{margin-top:8px}.mt-12{margin-top:12px}.mt-16{margin-top:16px}
.mb-8{margin-bottom:8px}.mb-12{margin-bottom:12px}
.text-center{text-align:center}.text-sm{font-size:0.88rem}.text-xs{font-size:0.74rem}
.text-muted{color:var(--muted)}.bold{font-weight:700}.text-accent{color:var(--accent)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}

/* ============ WELCOME ============ */
.welcome-wrap{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px;text-align:center;padding:20px 0}
.welcome-moon{font-size:5rem;animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.welcome-title{font-size:2.1rem;font-weight:900;font-family:'Amiri',serif;line-height:1.2;color:var(--accent)}
.welcome-sub{color:var(--muted);font-size:0.95rem}
.profile-entry-btn{background:var(--surf);border:1.5px solid var(--bdr);border-radius:16px;padding:11px 14px;display:flex;align-items:center;gap:12px;width:100%;color:var(--text);font-family:var(--font);font-size:0.95rem;font-weight:700;cursor:pointer}
.profile-entry-btn:active{transform:scale(0.97)}

/* ============ SETUP ============ */
.setup-step{display:none;flex-direction:column;gap:12px;flex:1}
.setup-step.active{display:flex}
.step-hdr{text-align:center;margin-bottom:6px}
.step-icon{font-size:3rem}
.avatar-tabs{display:flex;gap:6px;overflow-x:auto;padding-bottom:4px;margin-bottom:8px}
.avatar-tab{flex-shrink:0;padding:5px 12px;border-radius:20px;border:1.5px solid var(--bdr);background:var(--surf);font-size:0.8rem;cursor:pointer;color:var(--muted);font-family:var(--font);font-weight:700}
.avatar-tab.active{background:var(--accent);color:var(--text-on-accent);border-color:var(--accent)}
.avatar-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.av-btn{aspect-ratio:1;background:var(--surf);border:2px solid var(--bdr);border-radius:12px;font-size:1.6rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s}
.av-btn.selected{border-color:var(--accent);background:var(--alpha-accent-12);transform:scale(1.1)}
.hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.hero-btn{background:var(--surf);border:2px solid var(--bdr);border-radius:14px;padding:12px 8px;text-align:center;cursor:pointer;transition:all .15s}
.hero-btn.selected{border-color:var(--accent);background:var(--alpha-accent-12)}
.hero-icon{font-size:1.8rem}
.color-grid{display:grid;grid-template-columns:repeat(8,1fr);gap:6px}
.color-sw{aspect-ratio:1;border-radius:50%;cursor:pointer;border:3px solid transparent;transition:all .15s;min-height:28px}
.color-sw.selected{border-color:var(--text);transform:scale(1.2)}
.diff-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.diff-btn{background:var(--surf);border:2px solid var(--bdr);border-radius:14px;padding:14px 6px;text-align:center;cursor:pointer;transition:all .15s}
.diff-btn.selected{border-color:var(--accent);background:var(--alpha-accent-12)}
.slider-lbl{display:flex;justify-content:space-between;font-weight:700;font-size:0.9rem;margin-bottom:5px}
.slider-val{color:var(--accent);font-weight:900}
.total-info{text-align:center;padding:8px 12px;border-radius:12px;background:var(--surf);font-size:0.85rem;font-weight:700;color:var(--teal)}

/* ============ SYNC INDICATOR ============ */
#sync-indicator{position:fixed;top:8px;left:50%;transform:translateX(-50%);background:var(--accent);color:var(--core-black);padding:3px 12px;border-radius:18px;font-size:0.72rem;font-weight:700;opacity:0;transition:opacity .3s;z-index:999;pointer-events:none}
#sync-indicator.syncing{opacity:1}

/* ============ NAV ============ */
#nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:520px;background:var(--bg2);border-top:1px solid var(--bdr);display:none;grid-template-columns:repeat(5,1fr);z-index:100;padding-bottom:env(safe-area-inset-bottom,0)}
#nav.show{display:grid}
.nav-btn{display:flex;flex-direction:column;align-items:center;padding:10px 2px;background:none;border:none;color:var(--muted);font-family:var(--font);font-size:0.68rem;cursor:pointer;gap:2px;transition:color .15s;min-height:52px}
.nav-btn.active{color:var(--accent)}
.nav-i{font-size:1.25rem}

/* ============ HOME ============ */
.home-hdr{display:flex;align-items:center;gap:12px;margin-bottom:14px}
.home-av{font-size:2.8rem;cursor:pointer}
.home-name{font-size:1.25rem;font-weight:900}
.home-greet{font-size:0.82rem;color:var(--muted)}
.day-badge{background:var(--accent);color:var(--text-on-accent);font-weight:900;padding:4px 12px;border-radius:20px;font-size:0.88rem;white-space:nowrap;flex-shrink:0}

/* Timer card */
.timer-card{
  position:relative;
  border-radius:26px;
  padding:20px 18px 18px;
  border:3px solid var(--alpha-accent-90);
  background:
    radial-gradient(120% 140% at 20% 10%, var(--alpha-white-10) 0%, transparent 55%),
    linear-gradient(180deg, color-mix(in srgb, var(--bg) 92%, var(--core-black)) 0%, color-mix(in srgb, var(--bg2) 92%, var(--core-black)) 100%);
  box-shadow: 0 16px 40px var(--alpha-black-35);
  overflow:hidden;
  text-align:center;
  margin-bottom:14px;
}
.timer-card::before{
  content:'';
  position:absolute;
  inset:10px;
  border-radius:20px;
  border:1px solid color-mix(in srgb, var(--core-yellow-500) 28%, transparent);
  pointer-events:none;
}
[data-theme="day"] .timer-card,
[data-theme="girls"] .timer-card,
[data-theme="boys"] .timer-card{
  background:linear-gradient(135deg,var(--bg2),var(--bg3));
}

.timer-lbl{font-size:0.85rem;letter-spacing:.3px;color:color-mix(in srgb, var(--text) 72%, transparent)}
.timer-name{font-size:1.2rem;font-weight:900;color:var(--alpha-accent-95);margin:4px 0 10px}
.timer-display{
  font-size:3.2rem;
  font-weight:950;
  letter-spacing:3px;
  font-variant-numeric:tabular-nums;
  text-shadow:0 6px 18px var(--alpha-black-45);
}
#t-sub{font-size:0.9rem!important;color:color-mix(in srgb, var(--text) 78%, transparent)!important}

.prog-track{height:12px;border-radius:10px;background:var(--alpha-white-10);border:1px solid var(--alpha-white-08);position:relative;overflow:visible;margin-top:12px}
.prog-fill{height:100%;border-radius:10px;background:linear-gradient(90deg,var(--teal),var(--accent));transition:width .5s}
.prog-labels{display:flex;justify-content:space-between;font-size:0.78rem;color:color-mix(in srgb, var(--text) 70%, transparent);margin-bottom:3px}
.prog-marker{position:absolute;top:-6px;width:22px;height:22px;border-radius:50%;background:var(--alpha-accent-100);border:3px solid var(--overlay-deep-95);box-shadow:0 6px 16px var(--alpha-black-35);transform:translateX(50%);transition:right .5s}

.status-card{border-radius:16px;padding:12px 14px;margin-bottom:12px;font-size:0.9rem}
.status-pending{background:var(--surf);border:1.5px solid var(--accent)}
.status-success{background:var(--alpha-success-10);border:1.5px solid var(--green)}
.status-broke{background:var(--alpha-rose-10);border:1.5px solid var(--rose)}

/* Quiz banner */
.quiz-banner{
  background: linear-gradient(135deg,var(--purple),color-mix(in srgb,var(--purple) 70%,transparent),var(--preview-warm-2));
  border: 3px solid gold;
  border-radius: 26px;
  padding: 22px;
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 18px;
  box-shadow: 0 10px 25px var(--alpha-black-35), inset 0 0 12px var(--alpha-white-15);
  transform: scale(1);
  transition: transform .25s;
}
.quiz-banner:hover{ transform: scale(1.02); }
.quiz-banner .bold{ font-size: 1.25rem; }
#btn-quiz{ font-size: 1.1rem; padding: 10px 18px; border-radius: 14px; }

.section-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.section-title{font-weight:800;font-size:0.95rem}
.badge{background:var(--accent);color:var(--text-on-accent);font-size:0.72rem;font-weight:700;padding:2px 8px;border-radius:10px}
.deeds-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:12px}
.deed-btn{background:var(--surf);border:2px solid var(--bdr);border-radius:13px;padding:10px 6px;text-align:center;cursor:pointer;transition:all .15s;font-family:var(--font);min-height:78px;position:relative;color:var(--text)}
.deed-btn .deed-icon{font-size:1.6rem;display:block}
.deed-btn .deed-name{font-size:0.72rem;font-weight:700;display:block;margin:4px 0 2px;color:var(--text);line-height:1.2}
.deed-btn .deed-pts{font-size:0.68rem;color:var(--accent);font-weight:700}
.deed-btn.done{border-color:var(--green);background:var(--alpha-success-18)}
.deed-btn.done .deed-name,.deed-btn.done .deed-pts{color:var(--text-on-done)}
.deed-btn.pending-approval{border-color:var(--accent);background:var(--alpha-accent-12)}

/* ============ XP / STATS ============ */
.xp-bar-wrap{background:var(--surf);border:1px solid var(--bdr);border-radius:15px;padding:13px;margin-bottom:12px}
.xp-header{display:flex;justify-content:space-between;margin-bottom:5px}
.level-badge{background:var(--accent);color:var(--text-on-accent);padding:3px 10px;border-radius:10px;font-size:0.78rem;font-weight:700}
.xp-track{height:10px;background:var(--surf2);border-radius:5px;overflow:hidden}
.xp-fill{height:100%;background:linear-gradient(90deg,var(--teal),var(--accent));transition:width .5s}
.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:12px}
.stat-card{background:var(--surf);border:1px solid var(--bdr);border-radius:13px;padding:11px;text-align:center}
.stat-val{font-size:1.5rem;font-weight:900;color:var(--accent)}
.stat-lbl{font-size:0.72rem;color:var(--muted);margin-top:2px}
.journey-item{display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:11px;background:var(--surf);border:1px solid var(--bdr);margin-bottom:6px}
.journey-item.done{border-color:var(--green)}
.journey-item.current{border-color:var(--accent);background:var(--alpha-white-07)}
.ach-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:7px}
.ach-card{background:var(--surf);border:1px solid var(--bdr);border-radius:11px;padding:9px 5px;text-align:center}
.ach-card.unlocked{border-color:var(--accent);background:var(--alpha-accent-08)}

/* ============ LOG ============ */
.log-item{background:var(--surf);border:1px solid var(--bdr);border-radius:11px;padding:9px 12px;margin-bottom:6px;font-size:0.85rem}
.log-pending{border-color:var(--accent)}
.log-approved{border-color:var(--green)}
.log-rejected{border-color:var(--rose)}
.log-meta{display:flex;justify-content:space-between;align-items:center;font-size:0.75rem;color:var(--muted);margin-top:4px}

/* ============ SHOP ============ */
.shop-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.shop-item{background:var(--surf);border:1px solid var(--bdr);border-radius:15px;padding:13px;text-align:center}
.shop-item.owned{border-color:var(--green)}

/* ============ PARENT ============ */
.parent-lock{display:flex;flex-direction:column;align-items:center;gap:13px;text-align:center;padding:18px 0}
.math-q{font-size:1.9rem;font-weight:900;background:var(--surf);padding:12px 24px;border-radius:14px;color:var(--accent)}
.table-wrap{overflow-x:auto;border-radius:12px;border:1px solid var(--bdr)}
table{width:100%;border-collapse:collapse;font-size:0.82rem}
th{background:var(--bg3);padding:8px 10px;font-weight:700;color:var(--accent);border-bottom:1px solid var(--bdr);white-space:nowrap}
td{padding:8px 10px;border-bottom:1px solid var(--surf);color:var(--text);vertical-align:middle}
tr:last-child td{border-bottom:none}
tr:hover td{background:var(--surf)}
.child-card{display:flex;align-items:center;gap:11px;background:var(--surf);border:1.5px solid var(--bdr);border-radius:14px;padding:11px 13px;margin-bottom:7px}

/* ============ QUIZ ============ */
#screen-quiz .screen-title{font-size:1.15rem;font-weight:950}

.quiz-prog{height:10px;border-radius:999px;background:var(--alpha-white-10);border:1px solid var(--alpha-white-08);margin-bottom:13px;overflow:hidden}
.quiz-prog-fill{height:100%;background:linear-gradient(90deg,var(--teal),var(--accent));border-radius:999px;transition:width .3s}
.quiz-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;font-size:0.83rem}
.quiz-meta span{font-weight:800}
.quiz-q{
  border-radius:18px;
  border:1px solid var(--alpha-white-10);
  background:
    radial-gradient(120% 140% at 15% 15%, var(--alpha-white-10) 0%, transparent 60%),
    linear-gradient(180deg, var(--alpha-white-08), var(--alpha-white-03));
  box-shadow:0 14px 35px var(--alpha-black-22);
  padding:16px;
  font-size:1.05rem;
  font-weight:700;
  line-height:1.6;
  text-align:center;
  margin-bottom:14px;
  color:var(--text);
}
[data-theme="day"] .quiz-q,[data-theme="girls"] .quiz-q,[data-theme="boys"] .quiz-q{
  border-color:var(--bdr);
  background:var(--surf2);
}
.quiz-opts{display:flex;flex-direction:column;gap:9px}
.quiz-opt{
  border-radius:16px;
  border:2px solid var(--bdr);
  background:var(--surf);
  backdrop-filter: blur(8px);
  padding:12px 15px;
  font-size:0.92rem;
  font-weight:600;
  color:var(--text);
  font-family:var(--font);
  text-align:right;
  cursor:pointer;
  transition:all .2s;
  width:100%;
}
.quiz-opt:active{transform:scale(0.97)}
@media(hover:hover){
  .quiz-opt:hover:not(:disabled){background:var(--surf2);border-color:var(--accent);transform:scale(1.01)}
  .quiz-opt:hover:not(:disabled){transform:scale(1.02)}
}
.quiz-opt.correct{background:var(--state-success-600);border-color:var(--state-success-600);color:var(--core-white)!important;font-weight:800}
.quiz-opt.wrong{background:var(--state-danger-500);border-color:var(--state-danger-500);color:var(--core-white)!important;font-weight:800}
.quiz-opt:disabled{cursor:not-allowed;opacity:.85}
.quiz-fb{margin-top:11px;padding:11px 15px;border-radius:13px;font-weight:800;text-align:center;font-size:0.95rem}
.quiz-fb.correct{background:var(--state-success-600);color:var(--core-white);border:2px solid var(--state-success-600)}
.quiz-fb.wrong{background:var(--state-danger-500);color:var(--core-white);border:2px solid var(--state-danger-500)}
.quiz-locked{text-align:center;padding:30px 20px}
.quiz-locked-icon{font-size:3.5rem;margin-bottom:12px}
.quiz-shell{border-radius:22px;padding:14px 14px 16px;border:1px solid var(--alpha-white-10);background:linear-gradient(180deg,var(--alpha-white-06),var(--alpha-white-03));box-shadow:0 16px 40px var(--alpha-black-25);backdrop-filter:blur(10px)}

/* ============ CERTIFICATE ============ */
.cert-frame{background:linear-gradient(160deg,var(--bg2),var(--bg),var(--bg2));border:3px solid var(--accent);border-radius:24px;padding:26px 18px;text-align:center;position:relative;overflow:hidden}
[data-theme="day"] .cert-frame,[data-theme="girls"] .cert-frame,[data-theme="boys"] .cert-frame{background:linear-gradient(160deg,var(--bg2),var(--bg3))}
.cert-frame::before{content:'';position:absolute;inset:6px;border:1px solid var(--alpha-accent-30);border-radius:18px;pointer-events:none}
.cert-name{font-size:1.9rem;font-weight:900;font-family:'Amiri',serif}
.cert-row{display:flex;justify-content:center;gap:20px;font-size:0.95rem;font-weight:700;color:var(--teal);margin:10px 0}

/* ============ THEME PREVIEW ============ */
.theme-preview{background:var(--surf);border:1px solid var(--bdr);border-radius:14px;padding:13px;margin-bottom:8px}
.theme-preview-title{font-weight:800;font-size:0.9rem;color:var(--accent);margin-bottom:8px}
.preview-row{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:6px}

/* ============ THEME SWITCHER ============ */
.theme-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin:8px 0}
.theme-btn{border-radius:13px;padding:11px 5px;font-family:var(--font);font-size:0.78rem;font-weight:700;cursor:pointer;border:2px solid transparent;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:3px}
.theme-btn:active{transform:scale(0.95)}
.theme-btn.active{border-color:var(--text)!important;transform:scale(1.05)}
.t-night{background:linear-gradient(135deg,#162040,#0d1b3e);color:#e8d9b5}
.t-day{background:linear-gradient(135deg,#fff3d0,#fff8e8);color:#3a2800;border-color:#f0b429}
.t-girls{background:linear-gradient(135deg,#ffe0f0,#fce4f6);color:#3a0028;border-color:#e8009a}
.t-boys{background:linear-gradient(135deg,#d5eedd,#e4f2e8);color:#1a2e1a;border-color:#52d68a}

/* ============ MODAL ============ */
.overlay{position:fixed;inset:0;background:var(--alpha-black-72);z-index:500;display:flex;align-items:flex-end;justify-content:center;animation:fadeIn .2s}
.overlay.center{align-items:center}
.sheet{background:var(--bg2);border-radius:24px 24px 0 0;padding:18px 15px 30px;width:100%;max-width:480px;border-top:1px solid var(--bdr);max-height:88vh;overflow-y:auto}
.sheet.center-sheet{border-radius:20px;margin:16px}
.sheet-handle{width:38px;height:4px;background:var(--surf2);border-radius:2px;margin:0 auto 14px}
.modal-title{font-size:1.05rem;font-weight:800;color:var(--accent);margin-bottom:13px;text-align:center}

/* ============ TOAST & CONFETTI ============ */
#toast{position:fixed;top:18px;left:50%;transform:translateX(-50%) translateY(-10px);background:var(--bg2);border:1.5px solid var(--accent);border-radius:20px;padding:9px 18px;font-size:0.88rem;font-weight:700;z-index:9999;white-space:nowrap;max-width:90vw;box-shadow:var(--shadow);opacity:0;pointer-events:none;transition:all .3s}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.conf-p{position:fixed;pointer-events:none;z-index:9998;border-radius:2px;animation:confFall linear forwards}
@keyframes confFall{0%{transform:translateY(-10px) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}

/* ============ EID ============ */
.eid-wrap{text-align:center;padding:26px 18px}
.winner-card{background:linear-gradient(135deg,var(--alpha-accent-15),var(--alpha-teal-10));border:2px solid var(--accent);border-radius:18px;padding:16px;margin:12px 0}

/* ============ PRINT ============ */
@media print{body *{visibility:hidden}#screen-certificate,#screen-certificate *{visibility:visible}#screen-certificate{position:fixed;top:0;left:0;right:0;bottom:0}nav,.btn,button{display:none!important}}

/* ============ HOME INVENTORY SLIDER ============ */
#inv-strip{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding:6px 2px 10px;
  scroll-snap-type:x mandatory;
  -webkit-overflow-scrolling:touch;
}
#inv-strip::-webkit-scrollbar{height:8px}
#inv-strip::-webkit-scrollbar-thumb{background:var(--alpha-white-18);border-radius:999px}
.inv-card{
  min-width:124px;
  max-width:140px;
  flex:0 0 auto;
  scroll-snap-align:start;
  background:var(--surf);
  border:1px solid var(--alpha-white-14);
  border-radius:16px;
  padding:10px 10px 12px;
  box-shadow:0 8px 18px var(--alpha-black-12);
  text-align:center;
}
.inv-ic{font-size:2rem;line-height:1.2}
.inv-n{font-size:.85rem;font-weight:800;margin-top:6px;opacity:.95}
#home-inventory-card{margin-bottom:14px}

/* ============ CHILD GIFTS ============ */
.gift-card{
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px;
  border-radius:16px;
  background:var(--surf);
  border:1px solid var(--alpha-white-14);
  margin-top:10px;
}
.gift-ic{font-size:1.8rem}
.gift-b{flex:1;min-width:0}
.gift-t{font-weight:900;font-size:.95rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.gift-m{display:flex;gap:8px;margin-top:6px;flex-wrap:wrap}

/* ============ BUSY LOCK ============ */
body.is-busy #app{
  /* لا توقف النقرات بالكامل حتى لا تبدو الأزرار 'ميتة' */
  user-select:none;
  filter:saturate(.95);
}
body.is-busy .btn{opacity:.92}
body.is-busy .btn:active{transform:none}
body.is-busy #sync-indicator{
  opacity:1;
}

/* ============ SHOP v2 ============ */
#shop2-root{margin-top:12px}
.st2-sec{margin:0 0 18px 0}
.st2-sec-h{
  font-weight:900;
  font-size:0.95rem;
  padding:8px 12px;
  border-radius:14px;
  background:linear-gradient(180deg, var(--surf2), transparent);
  border:1px solid var(--bdr);
  color:var(--text);
}
.st2-grid{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr)) !important;
  gap:12px;
  margin-top:12px;
}
.st2-card{
  background:linear-gradient(180deg, var(--alpha-white-06), var(--alpha-white-02));
  border:1px solid var(--bdr);
  border-radius:22px;
  padding:14px 12px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  min-height:190px;
}
[data-theme="day"] .st2-card,[data-theme="girls"] .st2-card,[data-theme="boys"] .st2-card{
  background:linear-gradient(180deg, var(--surf2), var(--alpha-white-55));
}
.st2-ic{font-size:2.2rem;line-height:1;margin-bottom:8px}
.st2-name{font-weight:900;font-size:0.98rem;line-height:1.2;color:var(--text);margin-bottom:6px}
.st2-desc{font-size:0.8rem;line-height:1.3;color:var(--muted);min-height:34px}
.st2-price{margin-top:10px;font-weight:900;color:var(--teal);font-size:0.95rem}
.st2-btn{width:100%;margin-top:10px}
.st2-owned{opacity:0.82}

/* ============ GIFT CELEBRATION OVERLAY ============ */
.gift-celebrate-overlay{
  position:fixed;inset:0;z-index:9999;
  background:var(--alpha-black-45);
  display:flex;align-items:center;justify-content:center;
  padding:18px;
}
.gift-celebrate-card{
  width:min(420px,100%);
  border-radius:26px;
  padding:18px 16px;
  border:1px solid var(--bdr);
  background:linear-gradient(180deg, var(--bg2), var(--bg));
  box-shadow:var(--shadow);
  text-align:center;
}
.gift-celebrate-ic{font-size:2.2rem;margin-bottom:6px}
.gift-celebrate-title{font-weight:900;font-size:1.15rem;color:var(--accent)}
.gift-celebrate-text{margin-top:8px;font-size:0.95rem;color:var(--text);line-height:1.35}
.gift-celebrate-meta{margin-top:6px;font-size:0.85rem;color:var(--muted);font-weight:800}

/* ============ INSTALL BAR ============ */
.install-bar{display:flex;align-items:center;gap:10px;background:var(--surf);border:1.5px solid var(--bdr);border-radius:14px;padding:12px 14px}
